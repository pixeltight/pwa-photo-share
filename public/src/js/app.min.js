let deferredPrompt=null;const enableNotificationsButtons=document.querySelectorAll(".enable-notifications");window.Promise||(window.Promise=Promise),"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then(()=>{console.log("Service worker registered!")}).catch(i=>{console.log("[SERVICE WORKER] Event Registration error: ",i)}),window.addEventListener("beforeinstallprompt",i=>(console.log("beforeinstallprompt fired"),i.preventDefault(),deferredPrompt=i,!1));const displayConfirmNotification=()=>{if("serviceWorker"in navigator){let i={body:"You successfully subscribed to our notification service!",icon:"/src/images/icons/app-icon-96x96.png",dir:"ltr",lang:"en-US",vibrate:[100,50,200],badge:"/src/images/icons/app-icon-96x96.png",tag:"confirm-notification",renotify:!0,actions:[{action:"confirm",title:"Okay",icon:"/src/images/icons/app-icon-96x96.png"},{action:"confirm",title:"Cancel",icon:"/src/images/icons/app-icon-96x96.png"}]};navigator.serviceWorker.ready.then(o=>{o.showNotification("Sucessfully subscribed (from SW)!",i)})}},configurePushSub=()=>{if(!("serviceWorker"in navigator))return;let i;navigator.serviceWorker.ready.then(o=>(i=o,o.pushManager.getSubscription())).then(o=>{if(null===o){const o=urlBase64ToUint8Array("BEtJhcxi7UZqEjomaCxkhx9Gan02YmazKB-aKGj4iXA_GWilM-hbLYopldTYxHJN-K2qMnPezXQuGC1XjcLFlIk");return i.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:o})}}).then(i=>(console.log("78",i),fetch("https://pwa-max-6421b.firebaseio.com/subscriptions.json",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(i)}))).then(i=>{i.ok&&displayConfirmNotification()}).catch(i=>{console.log(i)})},askForNotificationPermission=()=>{Notification.requestPermission(i=>{console.log("%cUser Choice: "+i,"background: green; color: #FFF; font-size: 14px"),"granted"!==i?console.log("%cNo notification permission granted","background: purple; color: #FFF; font-size: 14px"):configurePushSub()})};if("Notification"in window&&"serviceWorker"in navigator)for(let i of enableNotificationsButtons)i.style.display="inline-block",i.addEventListener("click",askForNotificationPermission);